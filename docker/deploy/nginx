FROM node:latest AS builder
MAINTAINER Kaleidos hello@kaleidos.net

WORKDIR /

# Build the frontend application
COPY front /front
WORKDIR /front
RUN rm -rf build
RUN npm install
RUN npm run build
RUN rm -rf node_modules

# ------------------------------------------------------
# Configure nginx
# ------------------------------------------------------
FROM nginx:latest
COPY --from=builder /front/build /front/build

# Nginx config
ADD docker/deploy/nginx.conf /etc/nginx/nginx.conf


